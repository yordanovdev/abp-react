import e,{createContext as t,useState as n,useEffect as o,useContext as i}from"react";import r from"axios";let a={};a.appPath=a.appPath||"/",a.pageLoadTime=new Date,a.toAbsAppPath=function(e){return 0==e.indexOf("/")&&(e=e.substring(1)),a.appPath+e},a.multiTenancy=a.multiTenancy||{},a.multiTenancy.isEnabled=!1,a.multiTenancy.ignoreFeatureCheckForHostUsers=!1,a.multiTenancy.sides={TENANT:1,HOST:2},a.multiTenancy.tenantIdCookieName="Abp.TenantId",a.multiTenancy.setTenantIdCookie=function(e){e?a.utils.setCookieValue(a.multiTenancy.tenantIdCookieName,e.toString(),new Date((new Date).getTime()+15768e7),a.appPath,a.domain):a.utils.deleteCookie(a.multiTenancy.tenantIdCookieName,a.appPath)},a.multiTenancy.getTenantIdCookie=function(){var e=a.utils.getCookieValue(a.multiTenancy.tenantIdCookieName);return e?parseInt(e):null},a.session=a.session||{multiTenancySide:a.multiTenancy.sides.HOST},a.localization=a.localization||{},a.localization.languages=[],a.localization.currentLanguage={},a.localization.sources=[],a.localization.values={},a.localization.localize=function(e,t){t=t||a.localization.defaultSourceName;var n=a.localization.values[t];if(!n)return a.log.warn("Could not find localization source: "+t),e;var o=n[e];if(null==o)return e;var i=Array.prototype.slice.call(arguments,0);return i.splice(1,1),i[0]=o,a.utils.formatString.apply(this,i)},a.localization.getSource=function(e){return function(t){var n=Array.prototype.slice.call(arguments,0);return n.splice(1,0,e),a.localization.localize.apply(this,n)}},a.localization.isCurrentCulture=function(e){return a.localization.currentCulture&&a.localization.currentCulture.name&&0==a.localization.currentCulture.name.indexOf(e)},a.localization.defaultSourceName=void 0,a.localization.abpWeb=a.localization.getSource("AbpWeb"),a.auth=a.auth||{},a.auth.allPermissions=a.auth.allPermissions||{},a.auth.grantedPermissions=a.auth.grantedPermissions||{},a.auth.hasPermission=function(e){return a.auth.isGranted.apply(this,arguments)},a.auth.hasAnyOfPermissions=function(){return a.auth.isAnyGranted.apply(this,arguments)},a.auth.hasAllOfPermissions=function(){return a.auth.areAllGranted.apply(this,arguments)},a.auth.isGranted=function(e){return null!=a.auth.allPermissions[e]&&null!=a.auth.grantedPermissions[e]},a.auth.isAnyGranted=function(){if(!arguments||arguments.length<=0)return!0;for(var e=0;e<arguments.length;e++)if(a.auth.isGranted(arguments[e]))return!0;return!1},a.auth.areAllGranted=function(){if(!arguments||arguments.length<=0)return!0;for(var e=0;e<arguments.length;e++)if(!a.auth.isGranted(arguments[e]))return!1;return!0},a.auth.tokenCookieName="Abp.AuthToken",a.auth.setToken=function(e,t){a.utils.setCookieValue(a.auth.tokenCookieName,e,t,a.appPath,a.domain)},a.auth.getToken=function(){return a.utils.getCookieValue(a.auth.tokenCookieName)},a.auth.clearToken=function(){a.auth.setToken()},a.auth.refreshTokenCookieName="Abp.AuthRefreshToken",a.auth.setRefreshToken=function(e,t){a.utils.setCookieValue(a.auth.refreshTokenCookieName,e,t,a.appPath,a.domain)},a.auth.getRefreshToken=function(){return a.utils.getCookieValue(a.auth.refreshTokenCookieName)},a.auth.clearRefreshToken=function(){a.auth.setRefreshToken()},a.features=a.features||{},a.features.allFeatures=a.features.allFeatures||{},a.features.get=function(e){return a.features.allFeatures[e]},a.features.getValue=function(e){var t=a.features.get(e);if(null!=t)return t.value},a.features.isEnabled=function(e){var t=a.features.getValue(e);return"true"==t||"True"==t},a.setting=a.setting||{},a.setting.values=a.setting.values||{},a.setting.get=function(e){return a.setting.values[e]},a.setting.getBoolean=function(e){var t=a.setting.get(e);return"true"==t||"True"==t},a.setting.getInt=function(e){return parseInt(a.setting.values[e])},a.notifications=a.notifications||{},a.notifications.severity={INFO:0,SUCCESS:1,WARN:2,ERROR:3,FATAL:4},a.notifications.userNotificationState={UNREAD:0,READ:1},a.notifications.getUserNotificationStateAsString=function(e){switch(e){case a.notifications.userNotificationState.READ:return"READ";case a.notifications.userNotificationState.UNREAD:return"UNREAD";default:return a.log.warn("Unknown user notification state value: "+e),"?"}},a.notifications.getUiNotifyFuncBySeverity=function(e){switch(e){case a.notifications.severity.SUCCESS:return a.notify.success;case a.notifications.severity.WARN:return a.notify.warn;case a.notifications.severity.ERROR:case a.notifications.severity.FATAL:return a.notify.error;case a.notifications.severity.INFO:default:return a.notify.info}},a.notifications.messageFormatters={},a.notifications.messageFormatters["Abp.Notifications.MessageNotificationData"]=function(e){return e.notification.data.message||e.notification.data.properties.Message},a.notifications.messageFormatters["Abp.Notifications.LocalizableMessageNotificationData"]=function(e){var t=e.notification.data.message||e.notification.data.properties.Message,n=a.localization.localize(t.name,t.sourceName);if(e.notification.data.properties)for(var o=Object.keys(e.notification.data.properties),i=0;i<o.length;i++)n=n.replace("{"+o[i]+"}",e.notification.data.properties[o[i]]);return n},a.notifications.getFormattedMessageFromUserNotification=function(e){var t=a.notifications.messageFormatters[e.notification.data.type];return t?a.utils.isFunction(t)?t(e):(a.log.warn("Message formatter should be a function! It is invalid for data type: "+e.notification.data.type),"?"):(a.log.warn("No message formatter defined for given data type: "+e.notification.data.type),"?")},a.notifications.showUiNotifyForUserNotification=function(e,t){var n=a.notifications.getFormattedMessageFromUserNotification(e);a.notifications.getUiNotifyFuncBySeverity(e.notification.severity)(n,void 0,t)},a.log=a.log||{},a.log.levels={DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5},a.log.level=a.log.levels.DEBUG,a.log.log=function(e,t){window.console&&window.console.log&&null!=t&&a.log.level},a.log.debug=function(e){a.log.log("DEBUG: ",a.log.levels.DEBUG),a.log.log(e,a.log.levels.DEBUG)},a.log.info=function(e){a.log.log("INFO: ",a.log.levels.INFO),a.log.log(e,a.log.levels.INFO)},a.log.warn=function(e){a.log.log("WARN: ",a.log.levels.WARN),a.log.log(e,a.log.levels.WARN)},a.log.error=function(e){a.log.log("ERROR: ",a.log.levels.ERROR),a.log.log(e,a.log.levels.ERROR)},a.log.fatal=function(e){a.log.log("FATAL: ",a.log.levels.FATAL),a.log.log(e,a.log.levels.FATAL)},a.notify=a.notify||{},a.notify.success=function(e,t,n){a.log.warn("abp.notify.success is not implemented!")},a.notify.info=function(e,t,n){a.log.warn("abp.notify.info is not implemented!")},a.notify.warn=function(e,t,n){a.log.warn("abp.notify.warn is not implemented!")},a.notify.error=function(e,t,n){a.log.warn("abp.notify.error is not implemented!")},a.message=a.message||{};var u,l,s,c=function(e,t,n){alert((t||"")+" "+e)};function f(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function u(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}l((o=o.apply(e,t||[])).next())}))}function g(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(l){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(a=0)),a;)try{if(n=1,o&&(i=2&u[0]?o.return:u[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,u[1])).done)return i;switch(o=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,o=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(6===u[0]&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],o=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}}a.message.info=function(e,t,n){return a.log.warn("abp.message.info is not implemented!"),c(e,t)},a.message.success=function(e,t,n){return a.log.warn("abp.message.success is not implemented!"),c(e,t)},a.message.warn=function(e,t,n){return a.log.warn("abp.message.warn is not implemented!"),c(e,t)},a.message.error=function(e,t,n){return a.log.warn("abp.message.error is not implemented!"),c(e,t)},a.message.confirm=function(e,t,n,o){a.log.warn("abp.message.confirm is not implemented!");var i=window.confirm(e);n&&n(i)},a.ui=a.ui||{},a.ui.block=function(e){a.log.warn("abp.ui.block is not implemented!")},a.ui.unblock=function(e){a.log.warn("abp.ui.unblock is not implemented!")},a.ui.setBusy=function(e,t){a.log.warn("abp.ui.setBusy is not implemented!")},a.ui.clearBusy=function(e){a.log.warn("abp.ui.clearBusy is not implemented!")},a.event=(u={},{on:function(e,t){u[e]||(u[e]=[]),u[e].push(t)},off:function(e,t){var n=u[e];if(n){for(var o=-1,i=0;i<n.length;i++)if(n[i]===t){o=i;break}o<0||u[e].splice(o,1)}},trigger:function(e){var t=u[e];if(t&&t.length)for(var n=Array.prototype.slice.call(arguments,1),o=0;o<t.length;o++)t[o].apply(this,n)}}),a.utils=a.utils||{},a.utils.createNamespace=function(e,t){for(var n=t.split("."),o=0;o<n.length;o++)void 0===e[n[o]]&&(e[n[o]]={}),e=e[n[o]];return e},a.utils.replaceAll=function(e,t,n){var o=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return e.replace(new RegExp(o,"g"),n)},a.utils.formatString=function(){if(arguments.length<1)return null;for(var e=arguments[0],t=1;t<arguments.length;t++){var n="{"+(t-1)+"}";e=a.utils.replaceAll(e,n,arguments[t])}return e},a.utils.toPascalCase=function(e){return e&&e.length?1===e.length?e.charAt(0).toUpperCase():e.charAt(0).toUpperCase()+e.substr(1):e},a.utils.toCamelCase=function(e){return e&&e.length?1===e.length?e.charAt(0).toLowerCase():e.charAt(0).toLowerCase()+e.substr(1):e},a.utils.truncateString=function(e,t){return!e||!e.length||e.length<=t?e:e.substr(0,t)},a.utils.truncateStringWithPostfix=function(e,t,n){return n=n||"...",!e||!e.length||e.length<=t?e:t<=n.length?n.substr(0,t):e.substr(0,t-n.length)+n},a.utils.isFunction=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},a.utils.buildQueryString=function(e,t){void 0===t&&(t=!0);var n="";function o(){n.length?n+="&":t&&(n+="?")}for(var i=0;i<e.length;++i){var r=e[i];if(void 0!==r.value)if(null===r.value&&(r.value=""),o(),r.value.toJSON&&"function"==typeof r.value.toJSON)n=n+r.name+"="+encodeURIComponent(r.value.toJSON());else if(Array.isArray(r.value)&&r.value.length)for(var a=0;a<r.value.length;a++)a>0&&o(),n=n+r.name+"["+a+"]="+encodeURIComponent(r.value[a]);else n=n+r.name+"="+encodeURIComponent(r.value)}return n},a.utils.setCookieValue=function(e,t,n,o,i){var r=encodeURIComponent(e)+"=";t&&(r+=encodeURIComponent(t)),n&&(r=r+"; expires="+n.toUTCString()),o&&(r=r+"; path="+o),i&&(r=r+"; domain="+i),document.cookie=r},a.utils.getCookieValue=function(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++)if(t[n]){var o=t[n].split("=");if(2==o.length&&decodeURIComponent(o[0])===e)return decodeURIComponent(o[1]||"")}return null},a.utils.deleteCookie=function(e,t){var n=encodeURIComponent(e)+"=";n=n+"; expires="+new Date((new Date).getTime()-864e5).toUTCString(),t&&(n=n+"; path="+t),document.cookie=n},a.utils.getDomain=function(e){var t=/(https?:){0,1}\/\/((?:[\w\d-]+\.)+[\w\d]{2,})/i.exec(e);return t&&t[2]?t[2]:""},a.timing=a.timing||{},a.timing.utcClockProvider=(l=function(e){return Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())},{now:function(){return l(new Date)},normalize:function(e){return e?new Date(l(e)):e},supportsMultipleTimezone:!0}),a.timing.localClockProvider=(s=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},{now:function(){return s(new Date)},normalize:function(e){return e?s(e):e},supportsMultipleTimezone:!1}),a.timing.unspecifiedClockProvider={now:function(){return new Date},normalize:function(e){return e},supportsMultipleTimezone:!1},a.timing.convertToUserTimezone=function(e){var t=e.getTime()+6e4*e.getTimezoneOffset(),n=parseInt(t)+parseInt(a.timing.timeZoneInfo.windows.currentUtcOffsetInMilliseconds);return new Date(n)},a.clock=a.clock||{},a.clock.now=function(){return a.clock.provider?a.clock.provider.now():new Date},a.clock.normalize=function(e){return a.clock.provider?a.clock.provider.normalize(e):e},a.clock.provider=a.timing.unspecifiedClockProvider,a.security=a.security||{},a.security.antiForgery=a.security.antiForgery||{},a.security.antiForgery.tokenCookieName="XSRF-TOKEN",a.security.antiForgery.tokenHeaderName="X-XSRF-TOKEN",a.security.antiForgery.getToken=function(){return a.utils.getCookieValue(a.security.antiForgery.tokenCookieName)},a.security.antiForgery.shouldSendToken=function(e){return void 0===e.crossDomain||null===e.crossDomain?a.utils.getDomain(window.location.href)===a.utils.getDomain(e.url):!e.crossDomain},"function"==typeof SuppressedError&&SuppressedError;var p=t({user:null}),d=new(function(){function e(){}return e.prototype.loadScript=function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.body.appendChild(t)},e.prototype.setLocalization=function(){if(a.utils.getCookieValue("Abp.Localization.CultureName")){var e=navigator.language;a.utils.setCookieValue("Abp.Localization.CultureName",e,new Date((new Date).getTime()+15768e7),a.appPath)}},e.prototype.extend=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,o,i,r,a,u,l,s=e[0]||{},c=1,f=e.length,g=!1;for("boolean"==typeof s&&(g=s,s=e[c]||{},c++),"object"!=typeof s&&"function"!=typeof s&&(s={}),c===f&&(s=this,c--);c<f;c++)if(null!==(n=e[c]))for(o in n)i=s[o],s!==(a=n[o])&&(r=Array.isArray(i)?"array":typeof i,g&&a&&((u=Array.isArray(a))||"object"==typeof a)?(u?(u=!1,l=i&&"array"===r?i:[]):l=i&&"object"===r?i:{},s[o]=this.extend(g,l,a)):void 0!==a&&(s[o]=a));return s},e.prototype.getCurrentClockProvider=function(e){return"unspecifiedClockProvider"===e?a.timing.unspecifiedClockProvider:"utcClockProvider"===e?a.timing.utcClockProvider:a.timing.localClockProvider},e}()),m=function(e){d.extend(!0,a,e)},h=function(e,t){return void 0===t&&(t={}),f(void 0,void 0,void 0,(function(){var n,o,i;return g(this,(function(u){switch(u.label){case 0:return n=new URL("/AbpUserConfiguration/GetAll",e),[4,r.get(n.toString(),{headers:t}).catch((function(e){return console.log(e)}))];case 1:return(o=u.sent())&&(i=o.data.result,a.utils.getCookieValue("Abp.Localization.CultureName")||a.utils.setCookieValue("Abp.Localization.CultureName","en-US",new Date((new Date).getTime()+15768e7),a.appPath),a.clock.provider=d.getCurrentClockProvider(i.clock.provider),m(i)),[2]}}))}))},v=function(e,t,n){return f(void 0,void 0,void 0,(function(){var o,i,a;return g(this,(function(u){switch(u.label){case 0:return o=new URL("/api/services/app/Session/GetCurrentLoginInformations",e),[4,r.get(o.toString(),{headers:n}).catch((function(e){return console.log(e)}))];case 1:return(i=u.sent())&&(null==(a=i.data.result)?void 0:a.user)?(t(null==a?void 0:a.user),[2,null==a?void 0:a.user]):[2,null]}}))}))},y=function(t){var i=t.children,r=t.baseUrl,u=t.tenantId,l=n(null),s=l[0],c=l[1];return o((function(){if(!r)throw Error("Base url is not specified");var e=a.auth.getToken(),t={Authorization:e?"Bearer "+e:null,"Abp.TenantId":u};f(void 0,void 0,void 0,(function(){var e,n,o;return g(this,(function(i){switch(i.label){case 0:return n=(e=Promise).all,[4,h(r,t)];case 1:return o=[i.sent()],[4,v(r,c,t)];case 2:return[4,n.apply(e,[o.concat([i.sent()])])];case 3:return i.sent(),[2]}}))}))}),[]),e.createElement(p.Provider,{value:{user:s}},i)};y.defaultProps={tenantId:1};var k=function(){return a},C=function(){return i(p).user},w=function(e){var t=new Date((new Date).getTime()+1e3*e.expireInSeconds);return e.accessToken&&a.auth.setToken(e.accessToken,t),e.encryptedAccessToken&&a.utils.setCookieValue("enc_auth_token",e.encryptedAccessToken,t,a.appPath),e},T=function(){a.auth.clearToken(),a.auth.clearRefreshToken()};function b(e,t){return a.localization.localize(e,t)}export{y as AbpWrapper,b as L,a as abp,T as clearAuthCookies,m as initialiseApp,w as login,k as useAbp,C as useUser};
//# sourceMappingURL=index.js.map
